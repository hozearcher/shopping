<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>å¯æ„›å°èˆ– âœ¨ï¼ˆå‰ç«¯ç‰ˆï¼‰</title>
  <style>
    :root{
      --bg:#fff7fb; --card:#ffffff; --ink:#2b2b2b;
      --pink:#ff6fae; --pink2:#ffd1e6; --mint:#7ee0c3;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --radius:18px;
      font-family: ui-sans-serif, system-ui, "Noto Sans TC", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 20% 0%, #ffe6f2, transparent),
        radial-gradient(900px 600px at 90% 10%, #e8fff8, transparent),
        var(--bg);
      color:var(--ink);
    }
    header{
      position:sticky;top:0;z-index:10;
      backdrop-filter: blur(10px);
      background:rgba(255,247,251,.72);
      border-bottom:1px solid rgba(0,0,0,.06);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .brand{display:flex;gap:10px;align-items:center;font-weight:900}
    .logo{
      width:40px;height:40px;border-radius:14px;
      background:linear-gradient(135deg,var(--pink),var(--mint));
      box-shadow: var(--shadow);
    }
    .pill{
      display:flex;gap:10px;align-items:center;flex-wrap:wrap;
      background:rgba(255,255,255,.85);
      border:1px solid rgba(0,0,0,.07);
      padding:10px 12px;border-radius:999px;
      box-shadow: 0 6px 16px rgba(0,0,0,.05);
    }
    input,select{
      border:none;outline:none;background:transparent;
      font-size:14px; padding:4px 6px;
    }
    button{
      border:none;cursor:pointer;border-radius:999px;
      padding:10px 14px;font-weight:800;
    }
    .btn{
      background:linear-gradient(135deg,var(--pink),#ff9ed0);
      color:white; box-shadow: 0 10px 18px rgba(255,111,174,.25);
    }
    .btn2{background:rgba(0,0,0,.06);}
    .btn3{
      background:linear-gradient(135deg,#7ee0c3,#b8fff0);
      box-shadow: 0 10px 18px rgba(126,224,195,.25);
      font-weight:900;
    }
    .hero{
      margin-top:10px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
    }
    @media(max-width:900px){.hero{grid-template-columns:1fr}}
    .heroCard{
      background:rgba(255,255,255,.88);
      border:1px solid rgba(0,0,0,.06);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
      overflow:hidden;
      position:relative;
    }
    .spark{
      position:absolute; inset:-40px -40px auto auto;
      width:220px;height:220px;border-radius:999px;
      background:radial-gradient(circle at 30% 30%, rgba(255,111,174,.55), transparent 60%),
                 radial-gradient(circle at 70% 70%, rgba(126,224,195,.55), transparent 60%);
      filter: blur(0px);
      transform: rotate(18deg);
      pointer-events:none;
    }
    .hero h1{margin:0 0 10px;font-size:28px}
    .hero p{margin:0;opacity:.8;line-height:1.55}
    .badges{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    .badge{
      font-size:12px; padding:6px 10px;border-radius:999px;
      background:rgba(255,111,174,.12);
      border:1px dashed rgba(255,111,174,.35)
    }
    .grid{
      display:grid;grid-template-columns:repeat(4,1fr);
      gap:14px;margin-top:18px;
    }
    @media(max-width:980px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media(max-width:720px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:420px){.grid{grid-template-columns:1fr}}
    .card{
      background:rgba(255,255,255,.92);
      border:1px solid rgba(0,0,0,.06);
      border-radius:var(--radius);
      overflow:hidden;
      box-shadow: var(--shadow);
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .card:hover{transform: translateY(-2px); box-shadow: 0 14px 34px rgba(0,0,0,.10);}
    .img{
      aspect-ratio: 1/1;
      background:#f3f3f3;
      display:block;width:100%;object-fit:cover;
    }
    .pad{padding:12px}
    .title{font-weight:900;margin:0 0 6px; line-height:1.25}
    .meta{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .price{font-weight:1000;color:#ff3d97}
    .tag{
      font-size:12px;padding:6px 10px;border-radius:999px;
      background:rgba(255,111,174,.12);
      border:1px dashed rgba(255,111,174,.35)
    }
    .row{display:flex;justify-content:space-between;align-items:center;gap:10px}
    .small{font-size:12px; opacity:.75}
    .toast{
      position:fixed;left:50%;transform:translateX(-50%);
      bottom:18px;background:rgba(0,0,0,.78);
      color:white;padding:10px 12px;border-radius:12px;display:none;
      z-index:50;
    }

    /* Drawer / Modal */
    .overlay{
      position:fixed;inset:0;background:rgba(0,0,0,.35);
      display:none; z-index:19;
    }
    .drawer{
      position:fixed;right:0;top:0;height:100%;
      width:min(420px,100%);
      background:rgba(255,255,255,.96);
      border-left:1px solid rgba(0,0,0,.08);
      box-shadow: -20px 0 60px rgba(0,0,0,.12);
      transform:translateX(110%);
      transition:.25s; z-index:20;
    }
    .drawer.open{transform:translateX(0)}
    .overlay.open{display:block}
    .cartItem{padding:12px;border-bottom:1px solid rgba(0,0,0,.06)}
    .qty{display:flex;gap:8px;align-items:center}
    .qty button{padding:6px 10px}
    .formCard{
      background:rgba(0,0,0,.04);
      border:1px solid rgba(0,0,0,.06);
      border-radius:16px;
      padding:12px;
      display:flex;flex-direction:column;gap:8px;
    }
    .formCard input, .formCard textarea{
      background:rgba(255,255,255,.9);
      border:1px solid rgba(0,0,0,.08);
      border-radius:12px;
      padding:10px 12px;
      font-size:14px;
      outline:none;
    }
    textarea{resize:vertical;min-height:70px}
    .modal{
      position:fixed; inset:0; display:none; place-items:center;
      z-index:30;
    }
    .modal.open{display:grid}
    .modalCard{
      width:min(920px, calc(100% - 28px));
      background:rgba(255,255,255,.98);
      border:1px solid rgba(0,0,0,.08);
      border-radius:20px;
      box-shadow: 0 30px 90px rgba(0,0,0,.22);
      overflow:hidden;
    }
    .modalBody{
      display:grid; grid-template-columns: 1fr 1fr;
    }
    @media(max-width:860px){.modalBody{grid-template-columns:1fr}}
    .modalImg{
      width:100%; height:100%; min-height:320px;
      object-fit:cover; background:#f3f3f3;
    }
    .modalPad{padding:16px}
    .modalPad h2{margin:0 0 8px}
    .closeX{position:absolute; right:18px; top:16px}
    .footer{opacity:.75; font-size:12px; padding:30px 0;}
  </style>
</head>

<body>
<header>
  <div class="wrap topbar">
    <div class="brand">
      <div class="logo"></div>
      å¯æ„›å°èˆ– <span style="font-weight:700;opacity:.7">âœ¨ cute mall</span>
    </div>

    <div class="pill">
      <input id="q" placeholder="æœå°‹å¯æ„›å•†å“â€¦ï¼ˆä¾‹ï¼šè²¼ç´™/è²“/å……é›»ç·šï¼‰"/>
      <select id="cat">
        <option value="">å…¨éƒ¨åˆ†é¡</option>
        <option value="è²¼ç´™">è²¼ç´™</option>
        <option value="å°ç‰©">å°ç‰©</option>
        <option value="3C">3C</option>
        <option value="æ–‡å…·">æ–‡å…·</option>
      </select>
      <select id="sort">
        <option value="hot">æ¨è–¦</option>
        <option value="priceAsc">åƒ¹æ ¼ï¼šä½â†’é«˜</option>
        <option value="priceDesc">åƒ¹æ ¼ï¼šé«˜â†’ä½</option>
        <option value="new">æœ€æ–°</option>
      </select>
      <button class="btn2" onclick="applyFilters()">å¥—ç”¨</button>
    </div>

    <button class="btn" onclick="toggleCart(true)">
      è³¼ç‰©è»Š ğŸ§º <span id="cartCount">0</span>
    </button>
  </div>
</header>

<main class="wrap">
  <section class="hero">
    <div class="heroCard">
      <div class="spark"></div>
      <h1>æŠŠå¯æ„›å¸¶å›å®¶ ğŸ’–</h1>
      <p>é€™æ˜¯ã€Œç´”å‰ç«¯å•†åŸå¤–è§€ã€ç‰ˆæœ¬ï¼šå·²åŒ…å«æœå°‹ / åˆ†é¡ / æ’åº / å•†å“è©³æƒ… / è³¼ç‰©è»Š / å‡çµå¸³æµç¨‹ã€‚<br>
      ä¸‹ä¸€æ­¥ä½ è¦æ¥ Apps Script API æ™‚ï¼Œåªè¦æŠŠå•†å“è³‡æ–™æ”¹æˆå¾å¾Œç«¯è¼‰å…¥å³å¯ã€‚</p>
      <div class="badges">
        <div class="badge">ğŸŒ¸ Cute UI</div>
        <div class="badge">ğŸ§º Cart (localStorage)</div>
        <div class="badge">ğŸ” Search & Filter</div>
        <div class="badge">ğŸ§¾ Checkout (mock)</div>
      </div>
    </div>

    <div class="heroCard">
      <h3 style="margin:0 0 10px;">æœ¬é€±å„ªæƒ  ğŸ€</h3>
      <p style="opacity:.8;margin:0 0 12px;line-height:1.55">
        æ»¿ $499 å…é‹ï¼ˆç¤ºæ„ï¼‰<br>
        æ–°å“ä¸Šæ¶ï¼šæ£‰èŠ±ç³–å……é›»ç·šã€è²“è²“è²¼ç´™åŒ…
      </p>
      <button class="btn3" onclick="scrollToGrid()">é–‹å§‹é€›é€› ğŸ°</button>
      <div style="height:12px"></div>
      <button class="btn2" onclick="seedDemoCart()">ä¸€éµåŠ å…¥ç¤ºç¯„è³¼ç‰©è»Š</button>
    </div>
  </section>

  <h2 style="margin:18px 0 6px;">å•†å“åˆ—è¡¨ ğŸ§</h2>
  <div style="opacity:.75">é»å•†å“å¯çœ‹è©³æƒ…ï¼Œæˆ–ç›´æ¥åŠ å…¥è³¼ç‰©è»Šï½</div>

  <div id="grid" class="grid"></div>

  <div class="footer">Made with pure HTML (no API) Â· å¯æ„›å°èˆ– âœ¨</div>
</main>

<!-- Overlay + Cart Drawer -->
<div id="overlay" class="overlay" onclick="closeAll()"></div>

<div id="drawer" class="drawer" aria-label="cart">
  <div class="wrap">
    <div class="row" style="margin:10px 0;">
      <h3 style="margin:0;">ä½ çš„è³¼ç‰©è»Š ğŸ§</h3>
      <button class="btn2" onclick="toggleCart(false)">é—œé–‰</button>
    </div>

    <div id="cartList"></div>

    <div style="margin-top:12px;padding-top:12px;border-top:1px solid rgba(0,0,0,.06)">
      <div class="row"><div>å°è¨ˆ</div><div style="font-weight:1000" id="sum">$0</div></div>
      <div class="row" style="margin-top:6px">
        <div class="small">é‹è²»ï¼ˆç¤ºæ„ï¼‰</div>
        <div class="small" id="ship">$60</div>
      </div>
      <div class="row" style="margin-top:6px">
        <div style="font-weight:900">åˆè¨ˆ</div>
        <div style="font-weight:1000;color:#ff3d97" id="grand">$0</div>
      </div>

      <h4 style="margin:14px 0 8px;">çµå¸³è³‡è¨Šï¼ˆç¤ºæ„ï¼‰</h4>
      <div class="formCard">
        <input id="buyerName" placeholder="å§“å"/>
        <input id="buyerEmail" placeholder="Email"/>
        <input id="buyerPhone" placeholder="æ‰‹æ©Ÿ (é¸å¡«)"/>
        <textarea id="buyerNote" placeholder="å‚™è¨»ï¼ˆä¾‹ï¼šæ™šä¸Šæ”¶ä»¶ / ä¸è¦æ•²é–€ï¼‰"></textarea>
      </div>

      <div style="display:flex;gap:10px;margin-top:10px;">
        <button class="btn" style="flex:1" onclick="mockCheckout()">é€å‡ºè¨‚å–® ğŸ§¾</button>
        <button class="btn2" onclick="clearCart()">æ¸…ç©º</button>
      </div>

      <div style="margin-top:12px;opacity:.8;font-size:13px;line-height:1.45">
        â€» ç›®å‰ä¸æœƒçœŸçš„é€åˆ°å¾Œç«¯ï¼Œåªæœƒç”Ÿæˆä¸€å€‹ã€Œå‡è¨‚å–®è™Ÿã€ä¾›ä½ æ¸¬ UIã€‚
      </div>
    </div>
  </div>
</div>

<!-- Product Modal -->
<div id="modal" class="modal" aria-label="product modal">
  <div class="modalCard">
    <div style="position:relative">
      <button class="btn2 closeX" onclick="closeModal()">é—œé–‰</button>
    </div>
    <div class="modalBody">
      <img id="mImg" class="modalImg" alt="">
      <div class="modalPad">
        <div class="row">
          <div class="tag" id="mCat">åˆ†é¡</div>
          <div class="small">åº«å­˜ <span id="mStock">0</span></div>
        </div>
        <h2 id="mTitle"></h2>
        <div class="row" style="margin:10px 0 8px;">
          <div class="price" style="font-size:22px" id="mPrice">$0</div>
          <button class="btn" id="mAdd">åŠ å…¥ ğŸ§º</button>
        </div>
        <div style="opacity:.8;line-height:1.6" id="mDesc"></div>

        <div style="margin-top:14px">
          <div class="small">è³£å®¶ï¼ˆç¤ºæ„ï¼‰</div>
          <div style="font-weight:900" id="mSeller">ç”œç”œåœˆå°èˆ–</div>
        </div>

        <div style="margin-top:14px;opacity:.7;font-size:12px;line-height:1.5">
          ä¸‹ä¸€æ­¥æ¥ API å¾Œï¼šé€™è£¡å¯ä»¥æ”¾è©•åƒ¹ã€è¦æ ¼ã€ç‰©æµã€å„ªæƒ åˆ¸ç­‰ã€‚
        </div>
      </div>
    </div>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
  // ====== Demo products (no API) ======
  const PRODUCTS = [
    {
      id:"P001", title:"è²“è²“è²¼ç´™åŒ…ï¼ˆ20å…¥ï¼‰", price:79, stock:42, category:"è²¼ç´™",
      seller:"è²“çˆªå°åº—", desc:"é˜²æ°´æè³ªï¼Œé©åˆè²¼ç­†é›»/è¡Œæç®±ã€‚å¯æ„›åˆ°ä¸è¡Œï¼",
      image:"https://picsum.photos/seed/cat-sticker/800"
    },
    {
      id:"P002", title:"æ£‰èŠ±ç³–å……é›»ç·šï¼ˆType-Cï¼‰", price:199, stock:18, category:"3C",
      seller:"è»Ÿç³–é›»å™¨", desc:"æŸ”è»Ÿè€æŠ˜ï¼Œç²‰å«©é…è‰²ï¼Œå……é›»å¿ƒæƒ…è®Šå¥½ï½",
      image:"https://picsum.photos/seed/cable-cute/800"
    },
    {
      id:"P003", title:"å°ç†Šé€ å‹ä¾¿åˆ©è²¼", price:59, stock:65, category:"æ–‡å…·",
      seller:"å°ç†Šå•†åº—", desc:"å¯«æé†’è¶…ç™‚ç™’ï¼Œè²¼æ»¿æ¡Œé¢ä¹Ÿå¾ˆå¯æ„›ã€‚",
      image:"https://picsum.photos/seed/bear-note/800"
    },
    {
      id:"P004", title:"é›²æœµæ”¶ç´è¢‹ï¼ˆSï¼‰", price:129, stock:33, category:"å°ç‰©",
      seller:"é›²æœµå°èˆ–", desc:"æ”¾è€³æ©Ÿ/å……é›»å™¨/å£ç´…éƒ½å¯ä»¥ï¼Œå¤–å‡ºè¶…æ–¹ä¾¿ã€‚",
      image:"https://picsum.photos/seed/cloud-bag/800"
    },
    {
      id:"P005", title:"ç²‰å½©ç­†è¨˜æœ¬ï¼ˆA5ï¼‰", price:149, stock:22, category:"æ–‡å…·",
      seller:"ç”œç”œåœˆå°èˆ–", desc:"åšç£…ç´™ä¸é€å¢¨ï¼Œå°é¢æ˜¯å¥¶æ²¹ç²‰é…è‰²ã€‚",
      image:"https://picsum.photos/seed/pastel-book/800"
    },
    {
      id:"P006", title:"æ˜Ÿæ˜ŸåŠé£¾ï¼ˆéš¨æ©Ÿè‰²ï¼‰", price:89, stock:50, category:"å°ç‰©",
      seller:"æ˜Ÿæ˜Ÿå·¥åŠ", desc:"æ›åœ¨åŒ…åŒ…ä¸Šï¼Œèµ°åˆ°å“ªéƒ½é–ƒäº®äº®âœ¨",
      image:"https://picsum.photos/seed/star-charm/800"
    }
  ];

  // ====== Cart (localStorage) ======
  const LS_KEY = "cuteMallCart_v2";

  function toast(msg){
    const t = document.getElementById("toast");
    t.textContent = msg;
    t.style.display = "block";
    setTimeout(()=>t.style.display="none", 1600);
  }

  function getCart(){
    try { return JSON.parse(localStorage.getItem(LS_KEY) || "[]"); }
    catch { return []; }
  }
  function setCart(items){
    localStorage.setItem(LS_KEY, JSON.stringify(items));
    renderCartBadge();
  }
  function cartCount(){
    return getCart().reduce((s,x)=>s + (x.qty||0), 0);
  }
  function renderCartBadge(){
    document.getElementById("cartCount").textContent = cartCount();
  }

  function addToCart(productId){
    const p = PRODUCTS.find(x=>x.id===productId);
    if(!p) return;
    const cart = getCart();
    const found = cart.find(x=>x.productId===productId);
    if(found) found.qty += 1;
    else cart.push({ productId, title:p.title, price:p.price, qty:1 });
    setCart(cart);
    toast("å·²åŠ å…¥è³¼ç‰©è»Š âœ¨");
  }

  function updateQty(productId, delta){
    const cart = getCart();
    const it = cart.find(x=>x.productId===productId);
    if(!it) return;
    it.qty += delta;
    if(it.qty<=0) cart.splice(cart.indexOf(it),1);
    setCart(cart);
    renderCart();
  }

  function clearCart(){
    setCart([]);
    renderCart();
    toast("å·²æ¸…ç©º");
  }

  // ====== UI: Grid + Filters ======
  let filtered = [...PRODUCTS];

  function applyFilters(){
    const q = document.getElementById("q").value.trim().toLowerCase();
    const cat = document.getElementById("cat").value.trim();
    const sort = document.getElementById("sort").value;

    filtered = PRODUCTS
      .filter(p => !cat || p.category === cat)
      .filter(p => !q || (p.title + " " + p.desc + " " + p.seller).toLowerCase().includes(q));

    if(sort === "priceAsc") filtered.sort((a,b)=>a.price-b.price);
    if(sort === "priceDesc") filtered.sort((a,b)=>b.price-a.price);
    if(sort === "new") filtered.sort((a,b)=>b.id.localeCompare(a.id));
    if(sort === "hot") filtered.sort((a,b)=>(b.stock%7)-(a.stock%7)); // åªæ˜¯ç¤ºæ„

    renderGrid(filtered);
  }

  function renderGrid(items){
    const grid = document.getElementById("grid");
    grid.innerHTML = items.map(p => `
      <div class="card">
        <img class="img" src="${p.image}" alt="">
        <div class="pad">
          <div class="meta">
            <div class="tag">${p.category}</div>
            <div class="small">åº«å­˜ ${p.stock}</div>
          </div>
          <h3 class="title">${escapeHtml(p.title)}</h3>
          <div class="row">
            <div class="price">$${p.price}</div>
            <div style="display:flex;gap:8px">
              <button class="btn2" onclick="openModal('${p.id}')">è©³æƒ…</button>
              <button class="btn" onclick="addToCart('${p.id}')">åŠ å…¥ ğŸ§º</button>
            </div>
          </div>
          <div class="small" style="margin-top:8px;line-height:1.4">
            ${escapeHtml(p.desc.slice(0,52))}${p.desc.length>52?"â€¦":""}
          </div>
        </div>
      </div>
    `).join("");
  }

  function escapeHtml(s){
    return String(s||"").replace(/[&<>"']/g, m => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[m]));
  }

  function scrollToGrid(){
    document.getElementById("grid").scrollIntoView({behavior:"smooth", block:"start"});
  }

  // ====== Cart drawer ======
  function toggleCart(open){
    document.getElementById("drawer").classList.toggle("open", !!open);
    document.getElementById("overlay").classList.toggle("open", !!open);
    if(open) renderCart();
  }

  function closeAll(){
    toggleCart(false);
    closeModal();
  }

  function renderCart(){
    const cart = getCart();
    const list = document.getElementById("cartList");
    if(cart.length===0){
      list.innerHTML = `<div style="padding:18px;opacity:.7">é‚„æ²’æœ‰é¸å•†å“ï½å»é€›é€›å§ ğŸ°</div>`;
      document.getElementById("sum").textContent = "$0";
      document.getElementById("ship").textContent = "$0";
      document.getElementById("grand").textContent = "$0";
      return;
    }

    list.innerHTML = cart.map(it=>{
      const p = PRODUCTS.find(x=>x.id===it.productId);
      return `
        <div class="cartItem">
          <div class="row">
            <div style="font-weight:900">${escapeHtml(it.title)}</div>
            <div style="font-weight:1000;color:#ff3d97">$${it.price}</div>
          </div>
          <div class="row" style="margin-top:8px;">
            <div class="qty">
              <button class="btn2" onclick="updateQty('${it.productId}',-1)">-</button>
              <div style="min-width:24px;text-align:center;font-weight:900">${it.qty}</div>
              <button class="btn2" onclick="updateQty('${it.productId}',+1)">+</button>
            </div>
            <div class="small">å°è¨ˆ $${it.qty * it.price}</div>
          </div>
          <div class="small" style="margin-top:6px">è³£å®¶ï¼š${escapeHtml(p?.seller || "â€”")}</div>
        </div>
      `;
    }).join("");

    const sum = cart.reduce((s,x)=>s + x.qty*x.price,0);
    const ship = sum >= 499 ? 0 : 60; // ç¤ºæ„ï¼šæ»¿é¡å…é‹
    const grand = sum + ship;

    document.getElementById("sum").textContent = "$" + sum;
    document.getElementById("ship").textContent = "$" + ship;
    document.getElementById("grand").textContent = "$" + grand;
  }

  function seedDemoCart(){
    setCart([
      {productId:"P002", title:"æ£‰èŠ±ç³–å……é›»ç·šï¼ˆType-Cï¼‰", price:199, qty:1},
      {productId:"P001", title:"è²“è²“è²¼ç´™åŒ…ï¼ˆ20å…¥ï¼‰", price:79, qty:2}
    ]);
    toast("å·²åŠ å…¥ç¤ºç¯„å•†å“ ğŸ§");
    toggleCart(true);
  }

  // ====== Product modal ======
  function openModal(productId){
    const p = PRODUCTS.find(x=>x.id===productId);
    if(!p) return;

    document.getElementById("mImg").src = p.image;
    document.getElementById("mCat").textContent = p.category;
    document.getElementById("mStock").textContent = p.stock;
    document.getElementById("mTitle").textContent = p.title;
    document.getElementById("mPrice").textContent = "$" + p.price;
    document.getElementById("mDesc").textContent = p.desc;
    document.getElementById("mSeller").textContent = p.seller;

    const addBtn = document.getElementById("mAdd");
    addBtn.onclick = ()=> { addToCart(productId); };

    document.getElementById("modal").classList.add("open");
    document.getElementById("overlay").classList.add("open");
  }

  function closeModal(){
    document.getElementById("modal").classList.remove("open");
    // overlay å¯èƒ½é‚„åœ¨ï¼ˆè³¼ç‰©è»Šä¹Ÿæœƒç”¨ï¼‰ï¼Œæ‰€ä»¥ä¸å¼·åˆ¶é—œ
    const cartOpen = document.getElementById("drawer").classList.contains("open");
    if(!cartOpen) document.getElementById("overlay").classList.remove("open");
  }

  // ====== Mock checkout ======
  function mockCheckout(){
    const name = document.getElementById("buyerName").value.trim();
    const email = document.getElementById("buyerEmail").value.trim();
    const cart = getCart();
    if(!name || !email){ toast("è«‹å¡«å§“åèˆ‡ Email"); return; }
    if(cart.length===0){ toast("è³¼ç‰©è»Šæ˜¯ç©ºçš„"); return; }

    const orderId = "MOCK-" + Math.random().toString(16).slice(2,8).toUpperCase();
    toast("ä¸‹å–®æˆåŠŸï¼è¨‚å–®è™Ÿ " + orderId);
    clearCart();
    toggleCart(false);
  }

  // init
  renderCartBadge();
  applyFilters();

  // ESC to close
  window.addEventListener("keydown", (e)=>{
    if(e.key === "Escape") closeAll();
  });
</script>
</body>
</html>
